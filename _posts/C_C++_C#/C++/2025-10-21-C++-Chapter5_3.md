---
title: "[C++] Chapter 5.3 난수"
date: 2025-10-21 15:20:00 +0900
categories: ["C, C++, C#", C++]
tags: [programming, cpp, 프로그래밍, C++]
series: "따라하며 배우는 C++"
series_order : 26
math: true
image:
  path: https://imgur.com/Eqg7DeC.jpg
---

## 난수를 생성하는 원리

---

```cpp
#include <iostream>

using namespace std;

unsigned int PRNG()
{
  static unsigned int seed = 5523; // 임의의 seed값
  seed = 8235729 * seed + 2396403;  // overflow 

  return seed % 32768; // [0, 32767] 범위 값 반환
}

int main()
{
  for (int cnt = 1; cnt < 100; cnt++) 
  {
    cout << PRNG() << "\t";

    if (cnt % 5 == 0) 
      cout << endl;
  }
}
```

- `seed`를 `static`으로 선언해 난수 생성 시 시작 숫자로 설정
- `seed = 8235729 * seed + 2396403;`으로 overflow를 이용해 최대한 `seed` 값과 관련 없고 예측할 수 없는 난수를 생성
- `static` 변수 값은 메모리에 유지되므로 `PRNG()` 함수가 호출될 때마다 변한 `seed` 값으로 연산하게 됨
- 따라서 `seed` 값이 같으면 생성되는 난수도 같으므로 `seed` 값을 상수로 사용하기 보단 매 순간 변하는 **시간**을 이용하는 방법이 있음

## 난수 라이브러리

---

**\<csdlib\>**

- `std::rand()` : seed로부터 랜덤 값 생성
- `std::srand(Num)` : seed 값을 Num으로 설정
- seed 값이 상수라면 프로그램을 실행할 때마다 생성되는 난수 패턴이 똑같음

**\<ctime\>**  

- `std::time()` : 1970년 1월 1일을 기준으로 현재까지 경과된 시간을 초 단위로 반환

```cpp
std::srand(static_cast<unsigned int>(std::time(0)));

for (int cnt = 0; cnt < 100; cnt++)
{
  cout << std::rand() << "\t";

  if (cnt % 5 == 0) 
    cnt << endl; 
}
```

- seed 값을 `static_cast<unsigned int>(std::time(0))`로 설정
  - 현재 시간(초)를 `unsigned int`로 형변환
  - seed 값을 시간으로 설정해주면 프로그램 실행시마다 난수 패턴을 다르게 할 수 있음
- 디버깅할 때는 제대로된 동작을 확인하기 위해 상수로 설정하는 것이 좋음

## 특정한 정수 범위 사이의 난수 생성

---

```cpp
#include <iostream>
#include <cstdlib>
#include <ctime>

using namespace std;

int GetRandNum(int min, int max)
{
  static const double fraction = 1.0 / (RAND_MAX + 1.0);

  return min + static_cast<int>((max - min + 1)* (std::rand()*fraction));
}

int main()
{
  std::srand(static_cast<unsigned int>(std::time(0)));

  for(int cnt = 0; cnt < 100; cnt++)
  {
    cout << GetRandNum(5, 8)<< "\t";

    if (cnt % 5 == 0)
      cout << endl;
  }

  return 0;
}
```

- `RAND_MAX`로 난수 생성 시 최대 값을 정의
- `RAND_MAX + 1`의 역수인 `fraction`을 이용해 [0, 1) 범위의 난수를 생성
- 여기에 `(max - min + 1)`을 곱해 [0, max - min + 1) 범위의 난수를 생성
- `min` 값을 더해주면 최종적으로 [min, max + 1) 범위의 난수가 반환됨

```cpp
for(int cnt = 0; cnt < 100; cnt++)
{
  cout << std::rand() % 4 + 5 << "\t"; 

  if (cnt % 5 == 0) 
    cout << endl;
}
```

- `rand() % 4`는 0, 1, 2, 3 중 하나의 값이 되는데 5를 더해주면 5, 6, 7, 8 중 하나의 값이 됨
- 간단하게 구현할 수 있지만 특정 범위로 몰릴 수 있어 정밀한 난수가 필요한 경우 지양

**\<random\> 라이브러리**  

- C++ 11 이상부터 지원
- 난수가 특정 범위로 몰려 생성될 경우를 없애주고 각 숫자가 나올 확률을 전부 동일하게 함

```cpp
using namespace std;

int main()
{
  std::random_device rd; // seed 생성

  std::mt19937_64 mersenne(rd()); // 랜덤 숫자 생성 알고리즘
  std::uniform_int_distribution<> dice(1, 6); // 1 ~ 6 사이의 수 반환

  for (int cnt = 0; cnt < 20; cnt++)
    cout << dice(mersenne) << endl; 

  return 0;
}
```
